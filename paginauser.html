<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="perfil-container" style="max-width:600px; margin: 0 auto; padding:20px; font-family:Arial, sans-serif;">
    <div style="display:flex; align-items:center; gap:20px; margin-bottom:20px;">
        <img id="usuario-avatar" src="assets/images/default-avatar.png" 
             alt="Avatar do usuário" 
             style="width:80px; height:80px; border-radius:50%; object-fit:cover; border:2px solid #ccc;">
        <div>
            <h2 id="usuario-login">Login</h2>
            <p id="usuario-email" style="color:#555;">email@exemplo.com</p>
        </div>
    </div>

    <div style="display:flex; justify-content:space-between; margin-top:20px;">
        <div style="text-align:center; flex:1;">
            <h3 id="quant-seres">0</h3>
            <p>Seres cadastrados</p>
        </div>
        <div style="text-align:center; flex:1;">
            <h3 id="quant-denuncias">0</h3>
            <p>Denúncias feitas</p>
        </div>
    </div>
</div>

<script>
async function fetchUsuario() {
    try {
        // Supondo que você tenha um endpoint /api/usuarios/me retornando dados do usuário logado
        const resp = await fetch("http://localhost:8080/api/usuarios/me");
        if (!resp.ok) throw new Error("Erro ao buscar dados do usuário");
        const usuario = await resp.json();

        // Atualiza login, email e avatar
        document.getElementById("usuario-login").textContent = usuario.login;
        document.getElementById("usuario-email").textContent = usuario.email;
        if (usuario.avatar) {
            document.getElementById("usuario-avatar").src = `data:image/jpeg;base64,${usuario.avatar}`;
        }

        // Quantidade de seres cadastrados
        const respSeres = await fetch(`http://localhost:8080/api/seres?usuarioId=${usuario.id}`);
        const seres = await respSeres.json();
        document.getElementById("quant-seres").textContent = seres.length;

        // Quantidade de denúncias feitas
        const respDenuncias = await fetch(`http://localhost:8080/api/denuncias?usuarioId=${usuario.id}`);
        const denuncias = await respDenuncias.json();
        document.getElementById("quant-denuncias").textContent = denuncias.length;

    } catch (err) {
        console.error(err);
        alert("Erro ao carregar perfil do usuário");
    }
}

// Chama ao carregar a página
fetchUsuario();
</script>

</body>
</html>